---
title: Introduction to Data Science Final Project: Logistic Regression 
subtitle: Project Wine
output: html_document
author: Jonas, Eddie, Rishav, Anant
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
#Loading in Data and necessary libraries
library(caret)
library(ROCR)
library(glmnet)

redwine_data <- read.csv("winequality-red.csv")
whitewine_data <- read.csv2("winequality-white.csv")

whitewine_data[] <- lapply(whitewine_data, function(x) {
    if(is.factor(x)) {
      as.numeric(as.character(x))
      }
  else x
})
sapply(whitewine_data, class)

redwine_data$type <- "red"
whitewine_data$type <- "white"

wine_data <- rbind(redwine_data, whitewine_data)
```

```{r}

#Split into good and bad band (above 6 since 6 is the median)

redwine_data$qual_above_med <- (redwine_data$quality > 6)
whitewine_data$qual_above_med <- (whitewine_data$quality > 6)
wine_data$qual_above_med <- (wine_data$quality > 6)

```


Assumptions of Logistic regression

First, binary logistic regression requires the dependent variable to be binary and ordinal logistic regression requires the dependent variable to be ordinal.

Second, logistic regression requires the observations to be independent of each other.  In other words, the observations should not come from repeated measurements or matched data.

Third, logistic regression requires there to be little or no multicollinearity among the independent variables.  This means that the independent variables should not be too highly correlated with each other.

Fourth, logistic regression assumes linearity of independent variables and log odds.  although this analysis does not require the dependent and independent variables to be related linearly, it requires that the independent variables are linearly related to the log odds.

Finally, logistic regression typically requires a large sample size.  A general guideline is that you need at minimum of 10 cases with the least frequent outcome for each independent variable in your model. For example, if you have 5 independent variables and the expected probability of your least frequent outcome is .10, then you would need a minimum sample size of 500 (10*5 / .10).

```{r}

pairs(redwine_data[,-c(13,14)])
pairs(whitewine_data[,-c(13,14)])
pairs(wine_data[,-c(13,14)])

```

Red Wine
Fixed.acidity linearly correlated with citric acid, density and pH
citric acid with density and pH
Residual Sugar with density
Free sulfur dioxide with total sulfur dioxide
Density with alcohol

White Wine
Fixed.acidity linearly correlated with citric acid, density and pH
citric acid with density and pH
Free sulfur dioxide with total sulfur dioxide
Density with alcohol

Multicollinearity affects the coefficients and p-values, but it does not influence the predictions, precision of the predictions, and the goodness-of-fit statistics. If your primary goal is to make predictions, and you don’t need to understand the role of each independent variable, you don’t need to reduce severe multicollinearity.

The fact that some or all predictor variables are correlated among themselves does not, in general, inhibit our ability to obtain a good fit nor does it tend to affect inferences about mean responses or predictions of new observations.  —Applied Linear Statistical Models, p289, 4th Edition.

Remove some of the highly correlated independent variables.
Linearly combine the independent variables, such as adding them together.
Perform an analysis designed for highly correlated variables, such as principal components analysis or partial least squares regression.

```{r}

redwine_pca <- prcomp(redwine_data[,-c(13,14)], center = TRUE,scale. = TRUE)
summary(redwine_pca)

redwine_pca$rotation
redwine_pca$x

```

```{r}

redwine_mat <- as.matrix(redwine_data[,c(3:6,9,10)])

cv_result <- cv.glmnet(x = redwine_mat, y = redwine_data$qual_above_med,family= "binomial")

print(cv_result$lambda.min)
plot(cv_result)

tmp <- coef(glmnet(x = redwine_mat, y = redwine_data$qual_above_med,family= "binomial", lambda = cv_result$lambda.min))
rownames(tmp)[tmp[,1] != 0]

```

```{r}

whitewine_mat <- as.matrix(whitewine_data[,c(1:6,9)])

cv_result <- cv.glmnet(x = whitewine_mat, y = whitewine_data$qual_above_med,family= "binomial")

print(cv_result$lambda.min)
plot(cv_result)

tmp <- coef(glmnet(x = whitewine_mat, y = whitewine_data$qual_above_med,family= "binomial", lambda = cv_result$lambda.min))
rownames(tmp)[tmp[,1] != 0]

```

```{r}

wine_mat <- as.matrix(wine_data[,c(1:11)])

cv_result <- cv.glmnet(x = wine_mat, y = wine_data$qual_above_med,family= "binomial")

print(cv_result$lambda.min)
plot(cv_result)

tmp <- coef(glmnet(x = wine_mat, y = wine_data$qual_above_med,family= "binomial", lambda = cv_result$lambda.min))
rownames(tmp)[tmp[,1] != 0]

```

Both

Test new log reg with removed correlated var

Red Wine

corr_red_new <-cor(red[,c("citric.acid", 
"residual.sugar", "chlorides", "free.sulfur.dioxide", "sulphates", "alcohol")])

Back Elim

Use a p_val of 0.001

```{r}

red_new_lr <- glm(formula = redwine_data$qual_above_med ~ 
               redwine_data$citric.acid
              + redwine_data$residual.sugar + redwine_data$chlorides + redwine_data$free.sulfur.dioxide
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_new_lr)

```

As we can see residual.sugar has the highest p-val of 0.630051.

```{r}

red_new_lr_2 <- glm(formula = redwine_data$qual_above_med ~ 
               redwine_data$citric.acid + redwine_data$chlorides + redwine_data$free.sulfur.dioxide
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_new_lr_2)

```

If 0.05 stop here.

Significant var:
redwine_data$citric.acid + redwine_data$chlorides + redwine_data$free.sulfur.dioxide
              + redwine_data$sulphates + redwine_data$alcohol

redwine_data$free.sulfur.dioxide, with p val 0.026230

```{r}

red_new_lr_3 <- glm(formula = redwine_data$qual_above_med ~ 
               redwine_data$citric.acid + redwine_data$chlorides
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_new_lr_3)

```

Done.

Significant var:
 redwine_data$citric.acid + redwine_data$chlorides
              + redwine_data$sulphates + redwine_data$alcohol

FS

corr_red_new <-cor(red[,c("citric.acid", 
"residual.sugar", "chlorides", "free.sulfur.dioxide", "sulphates", "alcohol")])

```{r}

red_lr_new_fs1_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_new_fs1_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_new_fs1_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_new_fs1_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_new_fs1_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$sulphates,
              family = binomial(link="logit"))

red_lr_new_fs1_6 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_new_fs1_1)$coef
summary(red_lr_new_fs1_2)$coef
summary(red_lr_new_fs1_3)$coef
summary(red_lr_new_fs1_4)$coef
summary(red_lr_new_fs1_5)$coef
summary(red_lr_new_fs1_6)$coef


```

Add alcohol

```{r}

red_lr_new_fs2_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_new_fs2_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_new_fs2_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_new_fs2_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_new_fs2_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates,
              family = binomial(link="logit"))

summary(red_lr_new_fs2_1)$coef
summary(red_lr_new_fs2_2)$coef
summary(red_lr_new_fs2_3)$coef
summary(red_lr_new_fs2_4)$coef
summary(red_lr_new_fs2_5)$coef


```

Add sulphates

```{r}

red_lr_new_fs3_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates +  redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_new_fs3_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates +  redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_new_fs3_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates +  redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_new_fs3_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates +  redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))


summary(red_lr_new_fs3_1)$coef
summary(red_lr_new_fs3_2)$coef
summary(red_lr_new_fs3_3)$coef
summary(red_lr_new_fs3_4)$coef


```

```{r}


red_lr_new_fs4_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid +  redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_new_fs4_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid +  redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_new_fs4_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid +  redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))


summary(red_lr_new_fs4_1)$coef
summary(red_lr_new_fs4_2)$coef
summary(red_lr_new_fs4_3)$coef


```

Add chlorides


```{r}


red_lr_new_fs5_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid + redwine_data$chlorides +  redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_new_fs5_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid + redwine_data$chlorides +  redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))


summary(red_lr_new_fs5_1)$coef
summary(red_lr_new_fs5_2)$coef


```

if 0.001, stop here.

Significant var:
redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid +  redwine_data$chlorides

if 0.05, add free sulfur dioxide

```{r}


red_lr_new_fs6_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid + redwine_data$chlorides +  redwine_data$free.sulfur.dioxide + redwine_data$residual.sugar,
              family = binomial(link="logit"))


summary(red_lr_new_fs6_1)$coef

```

Dont add residual sugar. End FS here.

Significant var
redwine_data$alcohol + redwine_data$sulphates + redwine_data$citric.acid + redwine_data$chlorides +  redwine_data$free.sulfur.dioxide

White Wine

corr_white_new <- cor(white[, c("fixed.acidity", "volatile.acidity", "citric.acid", 
"residual.sugar", "chlorides", "free.sulfur.dioxide", "sulphates")])

```{r}

white_lr_new_1 <- glm(formula = whitewine_data$qual_above_med ~ 
                whitewine_data$fixed.acidity + whitewine_data$volatile.acidity +
                  whitewine_data$citric.acid + whitewine_data$residual.sugar + whitewine_data$chlorides +
                  whitewine_data$free.sulfur.dioxide +  whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_new_1)

```

whitewine_data$citric.acid 0.401049

```{r}

white_lr_new_2 <- glm(formula = whitewine_data$qual_above_med ~ 
                whitewine_data$fixed.acidity + whitewine_data$volatile.acidity +
                   whitewine_data$residual.sugar + whitewine_data$chlorides +
                  whitewine_data$free.sulfur.dioxide +  whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_new_2)

```

whitewine_data$free.sulfur.dioxide  0.105479 

```{r}

white_lr_new_3 <- glm(formula = whitewine_data$qual_above_med ~ 
                whitewine_data$fixed.acidity + whitewine_data$volatile.acidity +
                   whitewine_data$residual.sugar + whitewine_data$chlorides +  whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_new_3)

```


Stop here, nothing to remove.

Significant var:
whitewine_data$fixed.acidity + whitewine_data$volatile.acidity +
                   whitewine_data$residual.sugar + whitewine_data$chlorides +  whitewine_data$sulphates

FS

corr_white_new <- cor(white[, c("fixed.acidity", "volatile.acidity", "citric.acid", 
"residual.sugar", "chlorides", "free.sulfur.dioxide", "sulphates")])

```{r}

white_lr_new_fs1_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_new_fs1_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$volatile.acidity,
              family = binomial(link="logit"))

white_lr_new_fs1_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_new_fs1_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_new_fs1_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides,
              family = binomial(link="logit"))

white_lr_new_fs1_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_new_fs1_7 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_new_fs1_1)$coef
summary(white_lr_new_fs1_2)$coef
summary(white_lr_new_fs1_3)$coef
summary(white_lr_new_fs1_4)$coef
summary(white_lr_new_fs1_5)$coef
summary(white_lr_new_fs1_6)$coef
summary(white_lr_new_fs1_7)$coef
```

Add chlorides

```{r}

white_lr_new_fs2_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_new_fs2_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity,
              family = binomial(link="logit"))

white_lr_new_fs2_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_new_fs2_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_new_fs2_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_new_fs2_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides +  whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_new_fs2_1)$coef
summary(white_lr_new_fs2_2)$coef
summary(white_lr_new_fs2_3)$coef
summary(white_lr_new_fs2_4)$coef
summary(white_lr_new_fs2_5)$coef
summary(white_lr_new_fs2_6)$coef

```

whitewine_data$volatile.acidity 1.443031e-06

```{r}

white_lr_new_fs3_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity +  whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_new_fs3_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity +  whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_new_fs3_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity +  whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_new_fs3_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity +  whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_new_fs3_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides +whitewine_data$volatile.acidity + whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_new_fs3_1)$coef
summary(white_lr_new_fs3_2)$coef
summary(white_lr_new_fs3_3)$coef
summary(white_lr_new_fs3_4)$coef
summary(white_lr_new_fs3_5)$coef

```

whitewine_data$fixed.acidity 7.237755e-06

```{r}

white_lr_new_fs4_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +   whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_new_fs4_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_new_fs4_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_new_fs4_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides +whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_new_fs4_1)$coef
summary(white_lr_new_fs4_2)$coef
summary(white_lr_new_fs4_3)$coef
summary(white_lr_new_fs4_4)$coef

```

```{r}

white_lr_new_fs5_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$sulphates +   whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_new_fs5_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$sulphates +  whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_new_fs5_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$sulphates +  whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

summary(white_lr_new_fs5_1)$coef
summary(white_lr_new_fs5_2)$coef
summary(white_lr_new_fs5_3)$coef

```

whitewine_data$residual.sugar 3.793700e-04

```{r}

white_lr_new_fs6_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$sulphates + whitewine_data$residual.sugar +  whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_new_fs6_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$sulphates + whitewine_data$residual.sugar +  whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

summary(white_lr_new_fs6_1)$coef
summary(white_lr_new_fs6_2)$coef

```

Dont add any. End FS here.

Significant var:
whitewine_data$chlorides + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity +  whitewine_data$sulphates +  whitewine_data$residual.sugar


Red Wine

Backward Elimination

Use a p_val of 0.001

```{r}

red_lr <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$fixed.acidity + redwine_data$volatile.acidity + redwine_data$citric.acid
              + redwine_data$residual.sugar + redwine_data$chlorides + redwine_data$free.sulfur.dioxide
              + redwine_data$total.sulfur.dioxide + redwine_data$density + redwine_data$pH 
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr)

```

As we can see pH has the highest p-val of 0.822327.

```{r}

red_lr_2 <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$fixed.acidity + redwine_data$volatile.acidity + redwine_data$citric.acid
              + redwine_data$residual.sugar + redwine_data$chlorides + redwine_data$free.sulfur.dioxide
              + redwine_data$total.sulfur.dioxide + redwine_data$density
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_2)

```

As we can see citric acid has the highest p-val of 0.517160.

```{r}

red_lr_3 <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$fixed.acidity + redwine_data$volatile.acidity 
              + redwine_data$residual.sugar + redwine_data$chlorides + redwine_data$free.sulfur.dioxide
              + redwine_data$total.sulfur.dioxide + redwine_data$density
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_3)

```

As we can see free sulfur dioxide has the highest p-val of 0.387455.

```{r}

red_lr_4 <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$fixed.acidity + redwine_data$volatile.acidity 
              + redwine_data$residual.sugar + redwine_data$chlorides 
              + redwine_data$total.sulfur.dioxide + redwine_data$density
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_4)

```

if we were to use 0.05 or 0.01, stop here.

As we can see chlorides has the highest p-val of 0.009593.

```{r}

red_lr_5 <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$fixed.acidity + redwine_data$volatile.acidity 
              + redwine_data$residual.sugar
              + redwine_data$total.sulfur.dioxide + redwine_data$density
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_5)

```

As we can see density has the highest p-val of 0.004760.

```{r}

red_lr_6 <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$fixed.acidity + redwine_data$volatile.acidity 
              + redwine_data$residual.sugar
              + redwine_data$total.sulfur.dioxide 
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_6)

```

As we can see residual sugar has the highest p-val of 0.066968.

```{r}

red_lr_7 <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$fixed.acidity + redwine_data$volatile.acidity 
              + redwine_data$total.sulfur.dioxide 
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_7)

```

As we can see fixed acidity has the highest p-val of 0.01297.

```{r}


red_lr_8 <- glm(formula = redwine_data$qual_above_med ~ 
                redwine_data$volatile.acidity 
              + redwine_data$total.sulfur.dioxide 
              + redwine_data$sulphates + redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_8)


```

Forward selection

redwine_data$fixed.acidity + redwine_data$volatile.acidity + redwine_data$citric.acid
              + redwine_data$residual.sugar + redwine_data$chlorides + redwine_data$free.sulfur.dioxide
              + redwine_data$total.sulfur.dioxide + redwine_data$density + redwine_data$pH 
              + redwine_data$sulphates + redwine_data$alcohol

```{r}

red_lr_fs1_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$fixed.acidity,
              family = binomial(link="logit"))

red_lr_fs1_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$volatile.acidity,
              family = binomial(link="logit"))

red_lr_fs1_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs1_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_fs1_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_fs1_6 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs1_7 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs1_8 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs1_9 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$pH,
              family = binomial(link="logit"))

red_lr_fs1_10 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$sulphates,
              family = binomial(link="logit"))

red_lr_fs1_11 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol,
              family = binomial(link="logit"))

summary(red_lr_fs1_1)$coef
summary(red_lr_fs1_2)$coef
summary(red_lr_fs1_3)$coef
summary(red_lr_fs1_4)$coef
summary(red_lr_fs1_5)$coef
summary(red_lr_fs1_6)$coef
summary(red_lr_fs1_7)$coef
summary(red_lr_fs1_8)$coef
summary(red_lr_fs1_9)$coef
summary(red_lr_fs1_10)$coef
summary(red_lr_fs1_11)$coef

```

lowest pval is alcohol with 9.756085e-45.

```{r}

red_lr_fs2_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$fixed.acidity,
              family = binomial(link="logit"))

red_lr_fs2_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity,
              family = binomial(link="logit"))

red_lr_fs2_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs2_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_fs2_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_fs2_6 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs2_7 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs2_8 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs2_9 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$pH,
              family = binomial(link="logit"))

red_lr_fs2_10 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$sulphates,
              family = binomial(link="logit"))


summary(red_lr_fs2_1)$coef
summary(red_lr_fs2_2)$coef
summary(red_lr_fs2_3)$coef
summary(red_lr_fs2_4)$coef
summary(red_lr_fs2_5)$coef
summary(red_lr_fs2_6)$coef
summary(red_lr_fs2_7)$coef
summary(red_lr_fs2_8)$coef
summary(red_lr_fs2_9)$coef
summary(red_lr_fs2_10)$coef

```

lowest pval is volatile.acidity with 6.580944e-16

```{r}

red_lr_fs3_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$fixed.acidity,
              family = binomial(link="logit"))

red_lr_fs3_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs3_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_fs3_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_fs3_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs3_6 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs3_7 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs3_8 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$pH,
              family = binomial(link="logit"))

red_lr_fs3_9 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates,
              family = binomial(link="logit"))


summary(red_lr_fs3_1)$coef
summary(red_lr_fs3_2)$coef
summary(red_lr_fs3_3)$coef
summary(red_lr_fs3_4)$coef
summary(red_lr_fs3_5)$coef
summary(red_lr_fs3_6)$coef
summary(red_lr_fs3_7)$coef
summary(red_lr_fs3_8)$coef
summary(red_lr_fs3_9)$coef

```

lowest pval is sulphates with 4.477509e-09

```{r}

red_lr_fs4_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$fixed.acidity,
              family = binomial(link="logit"))

red_lr_fs4_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs4_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_fs4_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_fs4_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs4_6 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs4_7 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs4_8 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$pH,
              family = binomial(link="logit"))



summary(red_lr_fs4_1)$coef
summary(red_lr_fs4_2)$coef
summary(red_lr_fs4_3)$coef
summary(red_lr_fs4_4)$coef
summary(red_lr_fs4_5)$coef
summary(red_lr_fs4_6)$coef
summary(red_lr_fs4_7)$coef
summary(red_lr_fs4_8)$coef

```

lowest pval is total.sulfur.dioxide with 1.276479e-04

```{r}

red_lr_fs5_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity,
              family = binomial(link="logit"))

red_lr_fs5_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs5_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_fs5_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_fs5_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs5_6 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs5_7 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$pH,
              family = binomial(link="logit"))



summary(red_lr_fs5_1)$coef
summary(red_lr_fs5_2)$coef
summary(red_lr_fs5_3)$coef
summary(red_lr_fs5_4)$coef
summary(red_lr_fs5_5)$coef
summary(red_lr_fs5_6)$coef
summary(red_lr_fs5_7)$coef
```

All p val above 0.001, so we can stop here. If we use 0.05, we continue:

lowest pval is fixed.acidity with 1.297407e-02

```{r}

red_lr_fs6_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs6_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_fs6_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides,
              family = binomial(link="logit"))

red_lr_fs6_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs6_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs6_6 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$pH,
              family = binomial(link="logit"))



summary(red_lr_fs6_1)$coef
summary(red_lr_fs6_2)$coef
summary(red_lr_fs6_3)$coef
summary(red_lr_fs6_4)$coef
summary(red_lr_fs6_5)$coef
summary(red_lr_fs6_6)$coef

```

lowest pval is chlorides with 9.913224e-03

```{r}

red_lr_fs7_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs7_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar,
              family = binomial(link="logit"))

red_lr_fs7_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs7_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs7_5 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$pH,
              family = binomial(link="logit"))



summary(red_lr_fs7_1)$coef
summary(red_lr_fs7_2)$coef
summary(red_lr_fs7_3)$coef
summary(red_lr_fs7_4)$coef
summary(red_lr_fs7_5)$coef


```

lowest pval is residual.sugar with 2.935453e-02

```{r}

red_lr_fs8_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs8_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs8_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar + redwine_data$density,
              family = binomial(link="logit"))

red_lr_fs8_4 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar + redwine_data$pH,
              family = binomial(link="logit"))



summary(red_lr_fs8_1)$coef
summary(red_lr_fs8_2)$coef
summary(red_lr_fs8_3)$coef
summary(red_lr_fs8_4)$coef

```

lowest pval is density with 8.835069e-03

```{r}

red_lr_fs9_1 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar + redwine_data$density + redwine_data$citric.acid,
              family = binomial(link="logit"))

red_lr_fs9_2 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar + redwine_data$density + redwine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

red_lr_fs9_3 <- glm(formula = redwine_data$qual_above_med ~ redwine_data$alcohol + redwine_data$volatile.acidity + redwine_data$sulphates + redwine_data$total.sulfur.dioxide + redwine_data$fixed.acidity + redwine_data$chlorides + redwine_data$residual.sugar + redwine_data$density + redwine_data$pH,
              family = binomial(link="logit"))



summary(red_lr_fs9_1)$coef
summary(red_lr_fs9_2)$coef
summary(red_lr_fs9_3)$coef

```

All pvals are above 0.05, so we stop here.

White Wine

Backward Elimination

```{r}

white_lr_1 <- glm(formula = whitewine_data$qual_above_med ~ 
                whitewine_data$fixed.acidity + whitewine_data$volatile.acidity +
                  whitewine_data$citric.acid + whitewine_data$residual.sugar + whitewine_data$chlorides +
                  whitewine_data$free.sulfur.dioxide + whitewine_data$total.sulfur.dioxide +
                  whitewine_data$density + whitewine_data$pH + whitewine_data$sulphates + 
                  whitewine_data$alcohol,
              family = binomial(link="logit"))

summary(white_lr_1)

```

As we can see total.sulfur.dioxide has the highest p-val of 0.857936

```{r}

white_lr_2 <- glm(formula = whitewine_data$qual_above_med ~ 
               whitewine_data$fixed.acidity + whitewine_data$volatile.acidity +
                  whitewine_data$citric.acid + whitewine_data$residual.sugar + whitewine_data$chlorides +
                  whitewine_data$free.sulfur.dioxide + whitewine_data$density + whitewine_data$pH + 
                 whitewine_data$sulphates + whitewine_data$alcohol,
              family = binomial(link="logit"))

summary(white_lr_2)

```

As we can see alcohol has the highest p-val of 0.215846

```{r}

white_lr_3 <- glm(formula = whitewine_data$qual_above_med ~ 
               whitewine_data$fixed.acidity + whitewine_data$volatile.acidity +
                  whitewine_data$citric.acid + whitewine_data$residual.sugar + whitewine_data$chlorides +
                  whitewine_data$free.sulfur.dioxide + whitewine_data$density + whitewine_data$pH + 
                 whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_3)

```

As we can see citric.acid has the highest p-val of 0.081151

```{r}

white_lr_4 <- glm(formula = whitewine_data$qual_above_med ~ 
               whitewine_data$fixed.acidity + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$chlorides +
                  whitewine_data$free.sulfur.dioxide + whitewine_data$density + whitewine_data$pH + 
                 whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_4)

```

If pval 0.05, stop here

As we can see free.sulfur.dioxide has the highest p-val of 0.001118

```{r}

white_lr_5 <- glm(formula = whitewine_data$qual_above_med ~ 
               whitewine_data$fixed.acidity + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$chlorides + whitewine_data$density + whitewine_data$pH + 
                 whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_5)

```

As we can see chlorides has the highest p-val of 0.00133

```{r}

white_lr_6 <- glm(formula = whitewine_data$qual_above_med ~ 
               whitewine_data$fixed.acidity + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$density + whitewine_data$pH + 
                 whitewine_data$sulphates,
              family = binomial(link="logit"))

summary(white_lr_6)

```

All p-val below 0.001.

Forward selection

```{r}

white_lr_fs1_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs1_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$volatile.acidity,
              family = binomial(link="logit"))

white_lr_fs1_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs1_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_fs1_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$chlorides,
              family = binomial(link="logit"))

white_lr_fs1_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs1_7 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs1_8 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$density,
              family = binomial(link="logit"))

white_lr_fs1_9 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$pH,
              family = binomial(link="logit"))

white_lr_fs1_10 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$sulphates,
              family = binomial(link="logit"))

white_lr_fs1_11 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol,
              family = binomial(link="logit"))

summary(white_lr_fs1_1)$coef
summary(white_lr_fs1_2)$coef
summary(white_lr_fs1_3)$coef
summary(white_lr_fs1_4)$coef
summary(white_lr_fs1_5)$coef
summary(white_lr_fs1_6)$coef
summary(white_lr_fs1_7)$coef
summary(white_lr_fs1_8)$coef
summary(white_lr_fs1_9)$coef
summary(white_lr_fs1_10)$coef
summary(white_lr_fs1_11)$coef

```

lowest pval is alcohol with 1.439734e-135.

```{r}

white_lr_fs2_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs2_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity,
              family = binomial(link="logit"))

white_lr_fs2_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs2_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_fs2_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$chlorides,
              family = binomial(link="logit"))

white_lr_fs2_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs2_7 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs2_8 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$density,
              family = binomial(link="logit"))

white_lr_fs2_9 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$pH,
              family = binomial(link="logit"))

white_lr_fs2_10 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$sulphates,
              family = binomial(link="logit"))


summary(white_lr_fs2_1)$coef
summary(white_lr_fs2_2)$coef
summary(white_lr_fs2_3)$coef
summary(white_lr_fs2_4)$coef
summary(white_lr_fs2_5)$coef
summary(white_lr_fs2_6)$coef
summary(white_lr_fs2_7)$coef
summary(white_lr_fs2_8)$coef
summary(white_lr_fs2_9)$coef
summary(white_lr_fs2_10)$coef

```

lowest pval is volatile.acidity with 3.206406e-17.

```{r}

white_lr_fs3_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs3_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs3_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar,
              family = binomial(link="logit"))

white_lr_fs3_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$chlorides,
              family = binomial(link="logit"))

white_lr_fs3_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs3_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs3_7 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$density,
              family = binomial(link="logit"))

white_lr_fs3_8 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$pH,
              family = binomial(link="logit"))

white_lr_fs3_9 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$sulphates,
              family = binomial(link="logit"))


summary(white_lr_fs3_1)$coef
summary(white_lr_fs3_2)$coef
summary(white_lr_fs3_3)$coef
summary(white_lr_fs3_4)$coef
summary(white_lr_fs3_5)$coef
summary(white_lr_fs3_6)$coef
summary(white_lr_fs3_7)$coef
summary(white_lr_fs3_8)$coef
summary(white_lr_fs3_9)$coef

```

lowest pval is residual.sugar with 1.534664e-07.

```{r}

white_lr_fs4_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs4_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs4_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$chlorides,
              family = binomial(link="logit"))

white_lr_fs4_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs4_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs4_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$density,
              family = binomial(link="logit"))

white_lr_fs4_7 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH,
              family = binomial(link="logit"))

white_lr_fs4_8 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$sulphates,
              family = binomial(link="logit"))


summary(white_lr_fs4_1)$coef
summary(white_lr_fs4_2)$coef
summary(white_lr_fs4_3)$coef
summary(white_lr_fs4_4)$coef
summary(white_lr_fs4_5)$coef
summary(white_lr_fs4_6)$coef
summary(white_lr_fs4_7)$coef
summary(white_lr_fs4_8)$coef

```

lowest pval is pH with 8.459236e-07

```{r}

white_lr_fs5_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs5_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs5_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides,
              family = binomial(link="logit"))

white_lr_fs5_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs5_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs5_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$density,
              family = binomial(link="logit"))

white_lr_fs5_7 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$sulphates,
              family = binomial(link="logit"))


summary(white_lr_fs5_1)$coef
summary(white_lr_fs5_2)$coef
summary(white_lr_fs5_3)$coef
summary(white_lr_fs5_4)$coef
summary(white_lr_fs5_5)$coef
summary(white_lr_fs5_6)$coef
summary(white_lr_fs5_7)$coef

```

lowest pval is chlorides with 1.664074e-06


```{r}

white_lr_fs6_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs6_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs6_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs6_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs6_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$density,
              family = binomial(link="logit"))

white_lr_fs6_6 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates,
              family = binomial(link="logit"))


summary(white_lr_fs6_1)$coef
summary(white_lr_fs6_2)$coef
summary(white_lr_fs6_3)$coef
summary(white_lr_fs6_4)$coef
summary(white_lr_fs6_5)$coef
summary(white_lr_fs6_6)$coef

```

lowest pval is sulphates with 9.988478e-05

```{r}

white_lr_fs7_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs7_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs7_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs7_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs7_5 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density,
              family = binomial(link="logit"))


summary(white_lr_fs7_1)$coef
summary(white_lr_fs7_2)$coef
summary(white_lr_fs7_3)$coef
summary(white_lr_fs7_4)$coef
summary(white_lr_fs7_5)$coef

```

lowest pval is density with 1.485483e-06

```{r}

white_lr_fs8_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density + whitewine_data$fixed.acidity,
              family = binomial(link="logit"))

white_lr_fs8_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density + whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs8_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density + whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs8_4 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density + whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

summary(white_lr_fs8_1)$coef
summary(white_lr_fs8_2)$coef
summary(white_lr_fs8_3)$coef
summary(white_lr_fs8_4)$coef

```

lowest pval is fixed.acidity with 2.794502e-09
(This one is a bit weird)

```{r}

white_lr_fs9_1 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density + whitewine_data$fixed.acidity +  whitewine_data$citric.acid,
              family = binomial(link="logit"))

white_lr_fs9_2 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density + whitewine_data$fixed.acidity +  whitewine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

white_lr_fs9_3 <- glm(formula = whitewine_data$qual_above_med ~ whitewine_data$alcohol + whitewine_data$volatile.acidity + whitewine_data$residual.sugar + whitewine_data$pH + whitewine_data$chlorides + whitewine_data$sulphates + whitewine_data$density + whitewine_data$fixed.acidity +  whitewine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

summary(white_lr_fs9_1)$coef
summary(white_lr_fs9_2)$coef
summary(white_lr_fs9_3)$coef

```

All p vals above 0.001 and 0.05

Red Wine + White Wine

Backward Elimination

Use a p_val of 0.001

```{r}

redwhite_lr_1 <- glm(formula = wine_data$qual_above_med ~ 
                wine_data$fixed.acidity + wine_data$volatile.acidity + wine_data$citric.acid
              + wine_data$residual.sugar + wine_data$chlorides + wine_data$free.sulfur.dioxide
              + wine_data$total.sulfur.dioxide + wine_data$density + wine_data$pH 
              + wine_data$sulphates + wine_data$alcohol,
              family = binomial(link="logit"))

summary(redwhite_lr_1)

```

As we can see citric.acid has the highest p-val of 0.35357

```{r}

redwhite_lr_2 <- glm(formula = wine_data$qual_above_med ~ 
                wine_data$fixed.acidity + wine_data$volatile.acidity
              + wine_data$residual.sugar + wine_data$chlorides + wine_data$free.sulfur.dioxide
              + wine_data$total.sulfur.dioxide + wine_data$density + wine_data$pH 
              + wine_data$sulphates + wine_data$alcohol,
              family = binomial(link="logit"))

summary(redwhite_lr_2)

```

If p val stop at 0.01 or 0.05, can stop here

As we can see chlorides  has the highest p-val of 0.00718

```{r}

redwhite_lr_3 <- glm(formula = wine_data$qual_above_med ~ 
                wine_data$fixed.acidity + wine_data$volatile.acidity
              + wine_data$residual.sugar + wine_data$free.sulfur.dioxide
              + wine_data$total.sulfur.dioxide + wine_data$density + wine_data$pH 
              + wine_data$sulphates + wine_data$alcohol,
              family = binomial(link="logit"))

summary(redwhite_lr_3)

```

All p val below 0.001

Forward selection

```{r}

redwhite_lr_fs1_1 <- glm(formula = wine_data$qual_above_med ~ wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs1_2 <- glm(formula = wine_data$qual_above_med ~ wine_data$volatile.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs1_3 <- glm(formula = wine_data$qual_above_med ~ wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs1_4 <- glm(formula = wine_data$qual_above_med ~ wine_data$residual.sugar,
              family = binomial(link="logit"))

redwhite_lr_fs1_5 <- glm(formula = wine_data$qual_above_med ~ wine_data$chlorides,
              family = binomial(link="logit"))

redwhite_lr_fs1_6 <- glm(formula = wine_data$qual_above_med ~ wine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs1_7 <- glm(formula = wine_data$qual_above_med ~ wine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs1_8 <- glm(formula = wine_data$qual_above_med ~ wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs1_9 <- glm(formula = wine_data$qual_above_med ~ wine_data$pH,
              family = binomial(link="logit"))

redwhite_lr_fs1_10 <- glm(formula = wine_data$qual_above_med ~ wine_data$sulphates,
              family = binomial(link="logit"))

redwhite_lr_fs1_11 <- glm(formula = wine_data$qual_above_med ~ wine_data$alcohol,
              family = binomial(link="logit"))

summary(redwhite_lr_fs1_1)$coef
summary(redwhite_lr_fs1_2)$coef
summary(redwhite_lr_fs1_3)$coef
summary(redwhite_lr_fs1_4)$coef
summary(redwhite_lr_fs1_5)$coef
summary(redwhite_lr_fs1_6)$coef
summary(redwhite_lr_fs1_7)$coef
summary(redwhite_lr_fs1_8)$coef
summary(redwhite_lr_fs1_9)$coef
summary(redwhite_lr_fs1_10)$coef
summary(redwhite_lr_fs1_11)$coef

```

lowest pval is alcohol with 3.096691e-180

```{r}

redwhite_lr_fs2_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs2_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs2_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs2_4 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$residual.sugar,
              family = binomial(link="logit"))

redwhite_lr_fs2_5 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$chlorides,
              family = binomial(link="logit"))

redwhite_lr_fs2_6 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs2_7 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs2_8 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs2_9 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol +  wine_data$pH,
              family = binomial(link="logit"))

redwhite_lr_fs2_10 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$sulphates,
              family = binomial(link="logit"))


summary(redwhite_lr_fs2_1)$coef
summary(redwhite_lr_fs2_2)$coef
summary(redwhite_lr_fs2_3)$coef
summary(redwhite_lr_fs2_4)$coef
summary(redwhite_lr_fs2_5)$coef
summary(redwhite_lr_fs2_6)$coef
summary(redwhite_lr_fs2_7)$coef
summary(redwhite_lr_fs2_8)$coef
summary(redwhite_lr_fs2_9)$coef
summary(redwhite_lr_fs2_10)$coef

```

lowest pval is volatile.acidity with 1.114400e-35

```{r}

redwhite_lr_fs3_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs3_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs3_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$residual.sugar,
              family = binomial(link="logit"))

redwhite_lr_fs3_4 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$chlorides,
              family = binomial(link="logit"))

redwhite_lr_fs3_5 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs3_6 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs3_7 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs3_8 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +   wine_data$pH,
              family = binomial(link="logit"))

redwhite_lr_fs3_9 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity +  wine_data$sulphates,
              family = binomial(link="logit"))


summary(redwhite_lr_fs3_1)$coef
summary(redwhite_lr_fs3_2)$coef
summary(redwhite_lr_fs3_3)$coef
summary(redwhite_lr_fs3_4)$coef
summary(redwhite_lr_fs3_5)$coef
summary(redwhite_lr_fs3_6)$coef
summary(redwhite_lr_fs3_7)$coef
summary(redwhite_lr_fs3_8)$coef
summary(redwhite_lr_fs3_9)$coef

```

lowest pval is sulphates with 1.381116e-12

```{r}

redwhite_lr_fs4_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +   wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs4_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +   wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs4_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +   wine_data$residual.sugar,
              family = binomial(link="logit"))

redwhite_lr_fs4_4 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +   wine_data$chlorides,
              family = binomial(link="logit"))

redwhite_lr_fs4_5 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +   wine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs4_6 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +   wine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs4_7 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +   wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs4_8 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +  wine_data$pH,
              family = binomial(link="logit"))


summary(redwhite_lr_fs4_1)$coef
summary(redwhite_lr_fs4_2)$coef
summary(redwhite_lr_fs4_3)$coef
summary(redwhite_lr_fs4_4)$coef
summary(redwhite_lr_fs4_5)$coef
summary(redwhite_lr_fs4_6)$coef
summary(redwhite_lr_fs4_7)$coef
summary(redwhite_lr_fs4_8)$coef

```

lowest pval is residual.sugar  with 9.474215e-10

```{r}

redwhite_lr_fs5_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar +   wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs5_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar +   wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs5_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar +   wine_data$chlorides,
              family = binomial(link="logit"))

redwhite_lr_fs5_4 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar +   wine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs5_5 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +  wine_data$residual.sugar +  wine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs5_6 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar +   wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs5_7 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar +  wine_data$pH,
              family = binomial(link="logit"))


summary(redwhite_lr_fs5_1)$coef
summary(redwhite_lr_fs5_2)$coef
summary(redwhite_lr_fs5_3)$coef
summary(redwhite_lr_fs5_4)$coef
summary(redwhite_lr_fs5_5)$coef
summary(redwhite_lr_fs5_6)$coef
summary(redwhite_lr_fs5_7)$coef

```

lowest pval is chlorides with 3.297264e-04

```{r}

redwhite_lr_fs6_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides +   wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs6_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides +   wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs6_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides +   wine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs6_4 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates +  wine_data$residual.sugar + wine_data$chlorides +  wine_data$total.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs6_5 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides +   wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs6_6 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides +  wine_data$pH,
              family = binomial(link="logit"))


summary(redwhite_lr_fs6_1)$coef
summary(redwhite_lr_fs6_2)$coef
summary(redwhite_lr_fs6_3)$coef
summary(redwhite_lr_fs6_4)$coef
summary(redwhite_lr_fs6_5)$coef
summary(redwhite_lr_fs6_6)$coef

```

If we stop at pval 0.001, we stop here since all above 0.001

lowest pval is total.sulfur.dioxide with 2.262030e-03

```{r}

redwhite_lr_fs7_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +   wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs7_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +   wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs7_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +   wine_data$free.sulfur.dioxide,
              family = binomial(link="logit"))

redwhite_lr_fs7_4 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +   wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs7_5 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$pH,
              family = binomial(link="logit"))


summary(redwhite_lr_fs7_1)$coef
summary(redwhite_lr_fs7_2)$coef
summary(redwhite_lr_fs7_3)$coef
summary(redwhite_lr_fs7_4)$coef
summary(redwhite_lr_fs7_5)$coef

```

lowest pval is free.sulfur.dioxide with 6.371873e-06

```{r}

redwhite_lr_fs8_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +   wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs8_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +   wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs8_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +   wine_data$density,
              family = binomial(link="logit"))

redwhite_lr_fs8_4 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +  wine_data$pH,
              family = binomial(link="logit"))


summary(redwhite_lr_fs8_1)$coef
summary(redwhite_lr_fs8_2)$coef
summary(redwhite_lr_fs8_3)$coef
summary(redwhite_lr_fs8_4)$coef

```

lowest pval is pH with 9.133757e-03

```{r}

redwhite_lr_fs9_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +  wine_data$pH +   wine_data$fixed.acidity,
              family = binomial(link="logit"))

redwhite_lr_fs9_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +  wine_data$pH +   wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs9_3 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +  wine_data$pH +   wine_data$density,
              family = binomial(link="logit"))


summary(redwhite_lr_fs9_1)$coef
summary(redwhite_lr_fs9_2)$coef
summary(redwhite_lr_fs9_3)$coef

```

lowest pval is fixed.acidity with 1.679804e-04

```{r}

redwhite_lr_fs10_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +  wine_data$pH + wine_data$fixed.acidity +   wine_data$citric.acid,
              family = binomial(link="logit"))

redwhite_lr_fs10_2 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +  wine_data$pH + wine_data$fixed.acidity +   wine_data$density,
              family = binomial(link="logit"))


summary(redwhite_lr_fs10_1)$coef
summary(redwhite_lr_fs10_2)$coef

```

lowest pval is density with 1.098781e-08

```{r}

redwhite_lr_fs11_1 <- glm(formula = wine_data$qual_above_med ~  wine_data$alcohol + wine_data$volatile.acidity + wine_data$sulphates + wine_data$residual.sugar + wine_data$chlorides + wine_data$total.sulfur.dioxide +  wine_data$free.sulfur.dioxide +  wine_data$pH + wine_data$fixed.acidity + wine_data$density +  wine_data$citric.acid,
              family = binomial(link="logit"))


summary(redwhite_lr_fs11_1)$coef

```

pval is higher than 0.05, so we stop here.

ROC Curves

```{r}

set.seed(2121)

trainIndex <- createDataPartition(redwine_data$quality, p = .8, 
                                  list = FALSE, 
                                  times = 1)

redwine_data_train <- redwine_data[trainIndex,]
  
redwine_data_test <-  redwine_data[-trainIndex,]

```

```{r}

red_lr_train <- glm(formula = qual_above_med ~ 
                fixed.acidity + volatile.acidity + citric.acid
              + residual.sugar + chlorides + free.sulfur.dioxide
              + total.sulfur.dioxide + density + pH 
              + sulphates + alcohol, data = redwine_data_train,
              family = binomial(link="logit"))

summary(red_lr_train)

pred = predict.glm(red_lr_train, redwine_data_test,  type="response")
predObj <- prediction(pred, redwine_data_test$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

corr_red_new <-cor(red[,c("citric.acid", 
"residual.sugar", "chlorides", "free.sulfur.dioxide", "sulphates", "alcohol")])

```{r}

red_lr_train_reduced <- glm(formula = qual_above_med ~ 
                 citric.acid
              + residual.sugar + chlorides + free.sulfur.dioxide
              + sulphates + alcohol, data = redwine_data_train,
              family = binomial(link="logit"))

summary(red_lr_train_reduced)

pred = predict.glm(red_lr_train_reduced, redwine_data_test,  type="response")
predObj <- prediction(pred, redwine_data_test$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```



```{r}

set.seed(2121)

trainIndex <- createDataPartition(whitewine_data$quality, p = .8, 
                                  list = FALSE, 
                                  times = 1)

whitewine_data_train <- whitewine_data[trainIndex,]
  
whitewine_data_test <-  whitewine_data[-trainIndex,]

```

```{r}

white_lr_train <- glm(formula = qual_above_med ~ 
                fixed.acidity + volatile.acidity + citric.acid
              + residual.sugar + chlorides + free.sulfur.dioxide
              + total.sulfur.dioxide + density + pH 
              + sulphates + alcohol, data = whitewine_data_train,
              family = binomial(link="logit"))

pred = predict.glm(white_lr_train, whitewine_data_test,  type="response")
predObj <- prediction(pred, whitewine_data_test$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

corr_white_new <- cor(white[, c("fixed.acidity", "volatile.acidity", "citric.acid", 
"residual.sugar", "chlorides", "free.sulfur.dioxide", "sulphates")])

```{r}

white_lr_train_reduced <- glm(formula = qual_above_med ~ 
                fixed.acidity + volatile.acidity + citric.acid
              + residual.sugar + chlorides + free.sulfur.dioxide
              + sulphates, data = whitewine_data_train,
              family = binomial(link="logit"))

pred = predict.glm(white_lr_train_reduced, whitewine_data_test,  type="response")
predObj <- prediction(pred, whitewine_data_test$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

Red wine:

Full model

```{r}

summary(red_lr)

pred <- predict(red_lr,  type="response")
predObj <- prediction(pred, redwine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

```{r}

summary(red_new_lr)

pred <- predict(red_new_lr,  type="response")
predObj <- prediction(pred, redwine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

Backward elim pval 0.05

```{r}

pred <- predict(red_lr_4,  type="response")
predObj <- prediction(pred, redwine_data$qual_above_med )
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

Backward elim p val 0.001

```{r}

pred <- predict(red_lr_8,  type="response")
predObj <- prediction(pred, redwine_data$qual_above_med )
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```


FS p val 0.05

```{r}

pred <- predict(red_lr_fs8_3,  type="response")
predObj <- prediction(pred, redwine_data$qual_above_med )
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

FS p val 0.001

```{r}

pred <- predict(red_lr_fs4_6,  type="response")
predObj <- prediction(pred, redwine_data$qual_above_med )
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```


White wine:

Full model

```{r}

pred <- predict(white_lr_1,  type="response")
predObj <- prediction(pred, whitewine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

```{r}

pred <- predict(white_lr_new_1,  type="response")
predObj <- prediction(pred, whitewine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```


Backward Elim pval 0.05

```{r}

pred <- predict(white_lr_4,  type="response")
predObj <- prediction(pred, whitewine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

Backward Elim pval 0.001

```{r}

pred <- predict(white_lr_6,  type="response")
predObj <- prediction(pred, whitewine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

FS pval 0.05 and 0.001

```{r}

pred <- predict(white_lr_fs8_1 ,  type="response")
predObj <- prediction(pred, whitewine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```


Red and White wine:

Full model

```{r}

pred <- predict(redwhite_lr_1,  type="response")
predObj <- prediction(pred, wine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

Backward Elim pval 0.05

```{r}

pred <- predict(redwhite_lr_2,  type="response")
predObj <- prediction(pred, wine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

Backward Elim pval 0.001

```{r}

pred <- predict(redwhite_lr_3,  type="response")
predObj <- prediction(pred, wine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

FS pval 0.05

```{r}

pred <- predict(redwhite_lr_fs10_2,  type="response")
predObj <- prediction(pred, wine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```

FS pval 0.001

```{r}

pred <- predict(redwhite_lr_fs5_3,  type="response")
predObj <- prediction(pred, wine_data$qual_above_med)
rocObj = performance(predObj, measure="tpr", x.measure="fpr")
aucObj = performance(predObj, measure="auc")
plot(rocObj, main = paste("Area under the curve:",
round(aucObj@y.values[[1]] ,4)))

```



```{r}
fit3  <- rpart(qual_above_med ~  citric.acid + residual.sugar + chlorides + free.sulfur.dioxide + sulphates + alcohol, data=redwine_data,control=rpart.control(minsplit=80), method="class",
parms=list(split='information'))

summary(fit3)
rpart.plot(fit3, type=4, extra=1)
```
```{r}

pred <- prediction(predict(fit3, type = "prob")[, 2], redwine_data$qual_above_med)
plot(performance(pred, "tpr", "fpr"))
abline(0, 1, lty = 2)
auc <- performance(pred, "auc")
auc <- unlist(slot(auc,"y.values"))          
auc



```



































